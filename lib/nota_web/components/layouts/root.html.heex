<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />
    <.live_title default="Nota" suffix=" Â· Phoenix Framework">
      {assigns[:page_title]}
    </.live_title>
    <link phx-track-static rel="stylesheet" href={~p"/assets/css/app.css"} />
    <link rel="icon" href="/favicon.ico" sizes="48x48" />
    <link rel="apple-touch-icon" sizes="180x180" href={~s"/apple-touch-icon.png"} />
    <link rel="icon" type="image/png" sizes="32x32" href={~s"/favicon-32x32.png"} />
    <link rel="icon" type="image/png" sizes="16x16" href={~s"/favicon-16x16.png"} />
    <link rel="manifest" href={~s"/site.webmanifest"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/js/app.js"}>
    </script>
    <script>
      (() => {
        const setTheme = (theme) => {
          if (theme === "system") {
            localStorage.removeItem("phx:theme");
            document.documentElement.removeAttribute("data-theme");
          } else {
            localStorage.setItem("phx:theme", theme);
            document.documentElement.setAttribute("data-theme", theme);
          }
        };
        if (!document.documentElement.hasAttribute("data-theme")) {
          setTheme(localStorage.getItem("phx:theme") || "system");
        }
        window.addEventListener("storage", (e) => e.key === "phx:theme" && setTheme(e.newValue || "system"));

        window.addEventListener("phx:set-theme", (e) => setTheme(e.target.dataset.phxTheme));
      })();
    </script>
  </head>
  <body>
    <svg class="fixed inset-0 -z-10 h-full w-full" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="80%" y2="116%">
          <stop offset="2%" style="stop-color:#E34935" />
          <stop offset="100%" style="stop-color:#FAA53D" />
        </linearGradient>
      </defs>
      <rect width="100%" height="100%" fill="url(#bg-gradient)" />
    </svg>
    <svg
      class="fixed top-4 left-4 -z-10 w-1/3"
      viewBox="0, 0, 551.347, 800"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g transform="translate(-236.327, -112)" fill="currentColor" class="text-base-100/10">
        <path d="M733.697,594.42 L724.96,594.679 L628.851,291.791 L511.968,534.49 L395.149,291.791 L299.169,594.42 L290.238,594.42 L236.327,594.42 L389.13,112 L511.968,420.648 L634.87,112 L787.673,594.42 L733.697,594.42 z" />
        <path d="M236.327,606.394 L299.169,606.394 L511.968,797.058 L724.96,606.394 L787.673,606.394 L511.968,912 L236.327,606.394 z" />
      </g>
    </svg>
    <div class="bg-base-100/80 relative z-10 flex items-center justify-between px-4">
      <%!-- <div class="flex flex-row gap-2 items-center">
        <span
          class="h-10 inline-block bg-primary"
          style="aspect-ratio: 1; -webkit-mask: url('/images/movosoft-logo.svg') no-repeat center; mask: url('/images/movosoft-logo.svg') no-repeat center; -webkit-mask-size: contain; mask-size: contain;"
        />
      </div> --%>
      <img src={~s"/images/app-logo.svg"} class="h-4" />
      <ul class="menu menu-horizontal flex">
        <%= if @current_scope do %>
          <li :if={@current_scope.user.is_god}>
            <.link href={~p"/admin"}>Admin</.link>
          </li>
          <li>
            <.link href={~p"/notes"}>Notes</.link>
          </li>
          <li :if={Nota.Permissions.can?(@current_scope.user, :contacts)}>
            <.link href={~p"/contacts"}>Contacts</.link>
          </li>
          <li>
            <details>
              <summary>
                <span class="relative flex items-center gap-0">
                  {@current_scope.user.email}
                  <.god_icon :if={@current_scope.user.is_god} class="size-5" />
                </span>
              </summary>
              <ul class="right-0">
                <li>
                  <.link href={~p"/users/settings"}>Settings</.link>
                </li>
                <li>
                  <.link href={~p"/users/log-out"} method="delete">Log out</.link>
                </li>
              </ul>
            </details>
          </li>
        <% else %>
          <li>
            <.link href={~p"/users/register"}>Register</.link>
          </li>
          <li>
            <.link href={~p"/users/log-in"}>Log in</.link>
          </li>
        <% end %>
      </ul>
    </div>
    {@inner_content}
  </body>
</html>
